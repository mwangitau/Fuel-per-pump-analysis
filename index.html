<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shell Mangu Fuel Pump Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #3498db, #9b59b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .analysis-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        
        .analysis-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .insights-list {
            list-style: none;
            padding: 0;
        }
        
        .insights-list li {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .filter-section {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        select, button {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
        
        select:hover, button:hover {
            opacity: 0.9;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .data-table th, .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .data-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }
        
        .negative { color: #e74c3c; }
        .positive { color: #27ae60; }
    </style>
</head>
<body>
    <div class="container">
        <h1>â›½ Shell Mangu Fuel Pump Analysis - Volume Sales (Litres)</h1>
        
        <div class="metrics-grid" id="metricsGrid">
            <!-- Metrics will be populated by JavaScript -->
        </div>
        
        <div class="filter-section">
            <select id="attendantFilter">
                <option value="all">All Attendants</option>
            </select>
            <select id="pumpFilter">
                <option value="all">All Pumps</option>
                <option value="PUMP 1">Pump 1</option>
                <option value="PUMP 2">Pump 2</option>
                <option value="PUMP3">Pump 3</option>
            </select>
            <button onclick="updateAnalysis()">Update Analysis</button>
        </div>
        
        <div class="chart-container">
            <canvas id="dailySalesChart"></canvas>
        </div>
        
        <div class="chart-container">
            <canvas id="attendantPerformanceChart"></canvas>
        </div>
        
        <div class="chart-container">
            <canvas id="pumpComparisonChart"></canvas>
        </div>
        
        <div class="analysis-section">
            <h3>ðŸ“Š Key Insights</h3>
            <ul class="insights-list" id="insightsList">
                <!-- Insights will be populated by JavaScript -->
            </ul>
        </div>
        
        <div class="analysis-section">
            <h3>ðŸ“‹ Detailed Data</h3>
            <div style="overflow-x: auto;">
                <table class="data-table" id="dataTable">
                    <!-- Table will be populated by JavaScript -->
                </table>
            </div>
        </div>
    </div>

    <script>
        // Parse the data
        const rawData = [
            ["2025.09.01", "JOHN", -2241.63, "DAVID", -2342.78, "ZACHARIAH", -2361.36],
            ["2025.09.02", "THOMAS", 1628.94, "PAUL", -2352.54, "MACHARIAH", -1521.84],
            ["2025.09.03", "NJAGI", 1378.52, "JOHN", -2221.29, "DAVID", -1648.60],
            ["2025.09.04", "ZACHARIAH", -1798.99, "THOMAS", -2006.69, "PAUL", -2339.88],
            ["2025.09.05", "MACHARIAH", -1544.48, "NJAGI", -2113.93, "JOHN", -2191.75],
            ["2025.09.06", "DAVID", -1789.61, "ZACHARIAH", -2091.01, "THOMAS", -1657.91],
            ["2025.09.07", "PAUL", -1541.05, "MACHARIAH", -2051.98, "NJAGI", -872.94],
            ["2025.09.08", "JOHN", -1855.31, "DAVID", -2268.56, "ZACHARIAH", -3193.91],
            ["2025.09.09", "THOMAS", -1823.77, "PAUL", -2297.08, "MACHARIAH", -2235.23],
            ["2025.09.10", "NJAGI", -1778.04, "JOHN", -2490.68, "DAVID", -1847.23],
            ["2025.09.11", "ZACHARIAH", -1657.88, "THOMAS", -2223.40, "PAUL", -2016.43],
            ["2025.09.12", "MACHARIAH", -1100.16, "NJAGI", -2050.49, "JOHN", -3490.31],
            ["2025.09.13", "DAVID", -1693.39, "ZACHARIAH", -1950.51, "THOMAS", -1732.54],
            ["2025.09.14", "PAUL", -1390.86, "MACHARIAH", -2056.61, "PETER", -956.45],
            ["2025.09.15", "JOHN", -1452.21, "DAVID", -2190.35, "ZACHARIAH", -2210.97],
            ["2025.09.16", "THOMAS", -1657.78, "PAUL", -2182.67, "MACHARIAH", -1957.04],
            ["2025.09.17", "PETER", -1603.09, "JOHN", -2267.53, "DAVID", -1941.83],
            ["2025.09.18", "ZACHARIAH", -1556.79, "THOMAS", -2139.89, "PAUL", -1504.82],
            ["2025.09.19", "MACHARIAH", -1702.47, "PETER", -2132.35, "JOHN", -2027.97],
            ["2025.09.20", "DAVID", -1857.69, "ZACHARIAH", -2248.73, "THOMAS", -1853.25]
        ];

        // Process data
        let processedData = [];
        let attendants = new Set();
        let dailyTotals = {};
        let attendantTotals = {};
        let pumpTotals = {"PUMP 1": 0, "PUMP 2": 0, "PUMP3": 0};

        rawData.forEach(row => {
            const date = row[0];
            const pump1Data = {attendant: row[1], value: Math.abs(row[2])};
            const pump2Data = {attendant: row[3], value: Math.abs(row[4])};
            const pump3Data = {attendant: row[5], value: Math.abs(row[6])};
            
            processedData.push({
                date,
                pump1: pump1Data,
                pump2: pump2Data,
                pump3: pump3Data,
                total: pump1Data.value + pump2Data.value + pump3Data.value
            });
            
            // Collect attendants
            attendants.add(pump1Data.attendant);
            attendants.add(pump2Data.attendant);
            attendants.add(pump3Data.attendant);
            
            // Calculate totals
            dailyTotals[date] = pump1Data.value + pump2Data.value + pump3Data.value;
            
            [pump1Data, pump2Data, pump3Data].forEach((data, idx) => {
                const pumpName = idx === 0 ? "PUMP 1" : idx === 1 ? "PUMP 2" : "PUMP3";
                if (!attendantTotals[data.attendant]) attendantTotals[data.attendant] = 0;
                attendantTotals[data.attendant] += data.value;
                pumpTotals[pumpName] += data.value;
            });
        });

        // Populate attendant filter
        const attendantFilter = document.getElementById('attendantFilter');
        [...attendants].sort().forEach(attendant => {
            const option = document.createElement('option');
            option.value = attendant;
            option.textContent = attendant;
            attendantFilter.appendChild(option);
        });

        function updateMetrics() {
            const totalSales = Object.values(dailyTotals).reduce((a, b) => a + b, 0);
            const avgDaily = totalSales / Object.keys(dailyTotals).length;
            const bestDay = Object.keys(dailyTotals).reduce((a, b) => dailyTotals[a] > dailyTotals[b] ? a : b);
            const topAttendant = Object.keys(attendantTotals).reduce((a, b) => attendantTotals[a] > attendantTotals[b] ? a : b);
            const topPump = Object.keys(pumpTotals).reduce((a, b) => pumpTotals[a] > pumpTotals[b] ? a : b);

            const metricsHtml = `
                <div class="metric-card">
                    <div class="metric-value">${totalSales.toLocaleString()} L</div>
                    <div class="metric-label">Total Volume Sold</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${avgDaily.toLocaleString()} L</div>
                    <div class="metric-label">Average Daily Volume</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${bestDay}</div>
                    <div class="metric-label">Best Sales Day</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${topAttendant}</div>
                    <div class="metric-label">Top Performer</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${topPump}</div>
                    <div class="metric-label">Best Pump</div>
                </div>
            `;
            document.getElementById('metricsGrid').innerHTML = metricsHtml;
        }

        function createDailySalesChart() {
            const ctx = document.getElementById('dailySalesChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Object.keys(dailyTotals).map(date => date.substring(5)),
                    datasets: [{
                        label: 'Daily Volume (Litres)',
                        data: Object.values(dailyTotals),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Daily Fuel Volume Sales Trend'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' L';
                                }
                            }
                        }
                    }
                }
            });
        }

        function createAttendantChart() {
            const ctx = document.getElementById('attendantPerformanceChart').getContext('2d');
            const sortedAttendants = Object.entries(attendantTotals)
                .sort(([,a], [,b]) => b - a);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedAttendants.map(([name]) => name),
                    datasets: [{
                        label: 'Total Volume (Litres)',
                        data: sortedAttendants.map(([,value]) => value),
                        backgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#f5576c', 
                            '#4facfe', '#00f2fe', '#43e97b', '#38f9d7'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Attendant Performance Comparison'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' L';
                                }
                            }
                        }
                    }
                }
            });
        }

        function createPumpChart() {
            const ctx = document.getElementById('pumpComparisonChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(pumpTotals),
                    datasets: [{
                        data: Object.values(pumpTotals),
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Volume Sales by Pump (Litres)'
                        }
                    }
                }
            });
        }

        function updateInsights() {
            const insights = [
                `Total fuel volume sold: ${Object.values(dailyTotals).reduce((a, b) => a + b, 0).toLocaleString()} litres`,
                `Best performing attendant: ${Object.keys(attendantTotals).reduce((a, b) => attendantTotals[a] > attendantTotals[b] ? a : b)} with ${Math.max(...Object.values(attendantTotals)).toLocaleString()} litres`,
                `Most productive pump: ${Object.keys(pumpTotals).reduce((a, b) => pumpTotals[a] > pumpTotals[b] ? a : b)} with ${Math.max(...Object.values(pumpTotals)).toLocaleString()} litres`,
                `Average daily volume: ${(Object.values(dailyTotals).reduce((a, b) => a + b, 0) / Object.keys(dailyTotals).length).toLocaleString()} litres`,
                `Peak volume day: ${Object.keys(dailyTotals).reduce((a, b) => dailyTotals[a] > dailyTotals[b] ? a : b)} with ${Math.max(...Object.values(dailyTotals)).toLocaleString()} litres`,
                `${[...attendants].length} different attendants worked during this period`,
                `Price change noted on September 14th - may affect volume vs revenue relationship`,
                `Some negative values suggest fuel returns, tank calibrations, or system adjustments`
            ];

            const insightsHtml = insights.map(insight => `<li>${insight}</li>`).join('');
            document.getElementById('insightsList').innerHTML = insightsHtml;
        }

        function updateDataTable() {
            let tableHtml = `
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Pump 1 Attendant</th>
                        <th>Pump 1 Volume (L)</th>
                        <th>Pump 2 Attendant</th>
                        <th>Pump 2 Volume (L)</th>
                        <th>Pump 3 Attendant</th>
                        <th>Pump 3 Volume (L)</th>
                        <th>Daily Total (L)</th>
                    </tr>
                </thead>
                <tbody>
            `;

            processedData.forEach(row => {
                tableHtml += `
                    <tr>
                        <td>${row.date}</td>
                        <td>${row.pump1.attendant}</td>
                        <td>${row.pump1.value.toLocaleString()} L</td>
                        <td>${row.pump2.attendant}</td>
                        <td>${row.pump2.value.toLocaleString()} L</td>
                        <td>${row.pump3.attendant}</td>
                        <td>${row.pump3.value.toLocaleString()} L</td>
                        <td><strong>${row.total.toLocaleString()} L</strong></td>
                    </tr>
                `;
            });

            tableHtml += '</tbody>';
            document.getElementById('dataTable').innerHTML = tableHtml;
        }

        function updateAnalysis() {
            updateMetrics();
            updateInsights();
            updateDataTable();
        }

        // Initialize the dashboard when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateAnalysis();
            createDailySalesChart();
            createAttendantChart();
            createPumpChart();
        });
    </script>
</body>
</html>
